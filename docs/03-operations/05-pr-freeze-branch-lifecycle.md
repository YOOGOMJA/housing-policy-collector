# PR 동결(Freeze) 브랜치 수명주기 운영 가이드

Closed된 PR의 head 브랜치를 일관되게 정리해 저장소 브랜치 오염을 방지하고,
재사용 가능한 브랜치는 규칙 기반으로 보존하기 위한 운영 기준입니다.

## 1) 목적
- 머지/종료된 PR의 임시 브랜치를 주기적으로 정리해 브랜치 목록 가독성을 유지합니다.
- 재사용 예정 브랜치와 삭제 금지 브랜치를 분리해 운영 리스크를 줄입니다.
- 브랜치 정리 결과를 PR 동결 문서에 동기화해 누락을 방지합니다.

## 2) 분류 기준

### A. 삭제 대상 (기본)
- `Closed` 상태 PR의 head 브랜치 중 재사용 계획이 없는 브랜치
- 단기 실험/검증용 브랜치(`spike/*`, `test/*`)로 재오픈 계획이 없는 브랜치

### B. 보존 대상 (재사용 예정)
재사용 예정 브랜치는 아래 네이밍 중 하나를 사용해 보존합니다.

1. `archive/<원브랜치명>-YYYYMMDD`
   - 동일 이름 재생성을 허용하면서 이력 보존이 필요한 경우
2. `reuse/<도메인>/<설명>`
   - 후속 PR에서 지속적으로 재사용할 작업 브랜치

> 이미 존재하는 브랜치명을 archive 규칙으로 바꿀 때는 rename 후 원 브랜치를 삭제합니다.

### C. 삭제 금지 목록 (예외)
아래 유형은 `Closed PR`와 무관하게 삭제 금지 목록으로 관리합니다.

- 릴리즈 브랜치: `release/*`
- 핫픽스 브랜치: `hotfix/*`
- 장기 유지 브랜치: `lts/*`, `maintenance/*`
- 팀이 별도 지정한 상시 운영 브랜치

삭제 금지 목록은 팀 운영 정책 변경 시 즉시 갱신합니다.

## 3) 정리 절차

1. 원격 브랜치 최신화

```bash
git fetch --all --prune
```

2. Closed PR head 브랜치 목록 추출
   - GitHub UI 또는 CLI로 Closed PR의 head ref를 수집합니다.
3. 브랜치별 분류 수행
   - 삭제 대상 / 보존 대상 / 삭제 금지 목록으로 분류합니다.
4. 보존 대상 rename(필요 시)
   - `archive/*` 또는 `reuse/*` 규칙으로 rename
5. 삭제 대상 원격 브랜치 삭제

```bash
git push origin --delete <branch>
```

6. PR 동결 문서 동기화
   - 정리 일시, 삭제 브랜치, 보존 브랜치, 예외 브랜치 목록을 기록합니다.

## 4) PR 동결 문서 기록 템플릿

브랜치 정리 작업 PR에는 아래 표를 포함합니다.

| 항목 | 내용 |
| --- | --- |
| 정리 일시 | YYYY-MM-DD HH:mm (KST) |
| 대상 Closed PR 범위 | 예: #101 ~ #130 |
| 삭제 브랜치 | `feature/a`, `chore/b` |
| 보존 브랜치(archive/reuse) | `archive/feature-c-20260221`, `reuse/policy/eligibility-refactor` |
| 삭제 금지 예외 확인 | `release/1.2.0`, `hotfix/login-timeout` |
| 확인자 | @reviewer |

## 5) 점검 체크리스트
- [ ] Closed PR head 브랜치 전체를 수집했는가?
- [ ] 삭제 금지 목록과 교차 검증했는가?
- [ ] 재사용 예정 브랜치에 `archive/*` 또는 `reuse/*` 네이밍을 적용했는가?
- [ ] 원격 브랜치 삭제 후 `git branch -r`로 결과를 재확인했는가?
- [ ] 정리 결과를 PR 동결 문서(또는 PR 본문 freeze 섹션)에 기록했는가?

