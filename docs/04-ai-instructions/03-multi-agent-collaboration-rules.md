# 멀티 에이전트 협업 규칙 (PM/PO 운영안)

## 1) 현재 세팅 기준 진단
현재 문서 체계는 **순차 실행 정의**에는 강점이 있지만, 다음 항목이 비어 있습니다.

1. 병렬 작업 시 충돌 방지 규칙(소유권, 락, 우선순위)
2. 에이전트 간 인터페이스 계약(입출력 스키마, 상태 전이)
3. 품질 게이트의 실행 책임(누가 언제 무엇을 검증하는지)
4. 작업 인수인계 규칙(완료 정의, 증적, 롤백 기준)
5. 의사결정 이력(ADR) 및 변경 영향도 추적

## 2) 프로젝트 특성 기반 필수 추가 규칙
본 프로젝트는 정책 정확도/개인정보 보호/알림 신뢰성이 핵심이므로, 아래를 필수 규칙으로 둡니다.

### A. 작업 분할과 소유권
- 각 작업은 `한 에이전트 1 오너` 원칙으로 수행합니다.
- 공용 산출물은 섹션 단위 소유권을 명시합니다.
  - 예: `02-data-model.md`의 개인정보 필드는 Data-Agent 소유, 정책 조건은 Policy-Agent 승인 필수
- 동일 파일 동시 수정이 예상되면 선행으로 변경 범위를 합의합니다.

### B. 병렬 작업 제어
- 병렬 가능한 작업과 선행 의존 작업을 분리합니다.
  - 병렬 가능: Collector-Agent(수집 실패 감지) ↔ Notifier-Agent(전송/중복방지)
  - 의존 필요: Policy-Agent 정책 확정 → Matcher-Agent 판정 로직
- 병렬 작업 시 공통 계약 문서를 먼저 고정합니다.
  - 데이터 모델 버전
  - 이벤트/알림 페이로드 스키마
  - 상태 코드(성공/검토필요/실패)

### C. 품질 게이트(DoD)
- 코드 변경이 있는 경우:
  1. 린트 통과
  2. 컨벤션 체크 통과(커밋/네이밍/포맷)
- 문서 변경이 있는 경우:
  1. YAML 문서일 때만 포맷/문법 체크 실행
  2. 신규/변경 문서가 문서 인덱스 및 연관 문서에 반영됐는지 확인
- 정책 관련 변경이 있는 경우:
  - `검토필요` 분기 조건 및 개인정보 처리 영향도를 체크리스트로 첨부

### D. 인수인계 규칙
- 에이전트 완료 보고는 아래 4가지를 포함합니다.
  1. 변경 파일 목록
  2. 결정 사항과 근거
  3. 미해결 리스크
  4. 다음 에이전트 액션 아이템
- 다음 단계 에이전트는 이전 단계 산출물의 버전 태그를 참조해 시작합니다.

### E. 운영/장애 관점 협업
- Collector-Agent와 Ops-Agent는 수집 실패 이벤트 코드 체계를 공유합니다.
- Notifier-Agent와 Ops-Agent는 알림 지연/중복 지표 정의를 공유합니다.
- Incident 대응 시 PM/PO 판단이 필요한 정책 변경은 즉시 Product-Agent+Policy-Agent 동시 검토로 승격합니다.

## 3) 권장 산출물(추가하면 좋은 것)
1. `docs/04-ai-instructions/agent-ownership-matrix.yaml`
   - 에이전트별 책임 문서/승인권/대체 담당자
2. `docs/04-ai-instructions/interface-contracts.yaml`
   - 에이전트 간 입출력 스키마와 버전
3. `docs/03-operations/change-impact-checklist.yaml`
   - 정책/데이터/알림 변경 시 영향도 점검 항목
4. `docs/04-ai-instructions/decision-log.md`
   - 충돌 해결 및 예외 승인 이력(ADR 요약)

## 4) 즉시 적용 우선순위 (PM/PO 권고)
1. 소유권 매트릭스 + 인터페이스 계약부터 고정
2. 병렬 작업 시작 전 공통 상태코드/스키마 동결
3. PR 단위로 DoD 체크리스트 의무화
4. 운영 지표(지연/중복/실패)와 장애 코드를 에이전트 공통 언어로 통일
