# 적합도 판정 정책

## 1. 판정 등급
- 등급: `확정 가능` / `유력` / `검토필요` / `부적합`
- 누락 필드가 있으면 최대 `검토필요`
- 자격요건 충족 여부가 공고 원문에서 모호하면 보수적으로 `검토필요`

## 2. SH/LH 청약 형태 분류 기준(정규화)
수집 시 공고 원문의 유형명을 아래 `application_type`으로 정규화합니다. (파서 규격: `docs/02-tech-wiki/03-parser-spec.md`와 동기화)

- `PUBLIC_RENTAL` : `국민임대`, `영구임대`, `행복주택`, `장기전세`, `통합공공임대`, `공공임대`
- `PUBLIC_SALE` : `공공분양`, `신혼희망타운`, `분양`
- `JEONSE_RENTAL` : `전세임대`
- `PURCHASE_RENTAL` : `매입임대`
- `REDEVELOPMENT_SPECIAL` : `재개발`, `재건축`, `이주대책`, `특별공급`
- `UNKNOWN` : 분류 불가(원문 유지 + 수동 검토, `UNMAPPED_APPLICATION_TYPE` 로그 기록)
- `application_type_raw`가 공백/누락이면 `title` 기반 보완 추론 후 동일 enum 기준으로 정규화

## 3. SH/LH 공통 판정 항목
아래 항목을 기준으로 기본 적합도를 계산합니다.

- 지역 요건: 거주지/거주기간
- 세대 요건: 무주택 세대구성원 여부
- 소득 요건: 도시근로자 월평균 소득 대비 비율
- 자산 요건: 총자산/자동차 가액
- 청약통장 요건: 가입 기간/납입 횟수(해당 유형에 한함)
- 우선공급 요건: 청년/신혼부부/다자녀/고령자/장애인 등

## 4. SH/LH 유형별 판정 특성

### 4.1 `PUBLIC_RENTAL`
- 소득/자산 컷오프를 1차 필터로 우선 적용
- 동일 유형 내 우선공급 자격 충족 시 `유력` 이상 가능
- 자산 항목 누락 시 `검토필요`

### 4.2 `PUBLIC_SALE`
- 청약통장 요건(가입기간/납입횟수)과 특별공급 자격을 핵심 반영
- 분양가상한/지역우선 등 지역 규칙이 원문에 명시되면 추가 가중
- 통장 정보 미입력 시 최대 `검토필요`

### 4.3 `JEONSE_RENTAL` / `PURCHASE_RENTAL`
- 공급대상군(청년·신혼·고령자 등) 매칭이 1순위
- 소득/자산은 대상군별 기준표를 사용
- 대상군 미일치 시 `부적합`

### 4.4 `REDEVELOPMENT_SPECIAL`
- 일반 규칙 자동판정에서 제외 가능성이 높으므로 기본 `검토필요`
- 프로젝트 운영자가 수동 심사 규칙을 별도로 적용

### 4.5 `UNKNOWN`
- 자동으로 `검토필요`
- 파서 개선 후보로 기록하여 파싱 규격 문서에 반영

## 5. 예외 처리
- SH/LH 원문 공고와 파싱 데이터가 충돌하면 원문 우선
- 원문 모호성/해석 불가 문구는 `AMBIGUOUS_RULE_TEXT`로 로그 메타데이터에 기록
- 모호성 근거 문구는 `log.metadata.ambiguous_fragments` 배열에 보존
- 하나라도 법적 필수 자격(무주택, 세대요건 등) 위배 시 `부적합`
- 마감 임박 공고는 판정과 별개로 우선 알림 가능(정책 분리)

## 6. POC 범위와 차기 단계

### 6.1 현재 POC 범위
- 초기 자동 판정은 보수 규칙만 적용합니다.
  - 입력 데이터(`region/income/asset`) 누락 시 최대 `검토필요`
  - 법적 필수 조건(예: 무주택) 위배가 명확하면 즉시 `부적합`
  - `application_type=UNKNOWN` 또는 모호성 플래그 존재 시 자동 `검토필요`
- 초기 판정 결과는 사용자 설명 가능성을 위해 `grade`, `reasons[]`를 반드시 남깁니다.

### 6.2 차기 단계(정밀 모델)
- 정밀 가점/감점 모델 도입(공급유형별 세부 점수표)
- 청약통장/우선공급 요건의 정량 반영
- 공고문 원문 근거 문장과 판정 사유의 1:1 링크 제공
- 유형별(`PUBLIC_RENTAL`, `PUBLIC_SALE` 등) 캘리브레이션 및 오탐/미탐 모니터링

